% CAPITULO 1: EXPLICO EL ESQUEMA GENERAL DEL ALGORITMO

\chapter{Método/herramienta desarrollada}
\label{method}


\section{Fundamentos del método}

% Mapeo de los objetivos con existencia de herramientas disponibles.

% PRIMERO QUE BUSCAMOS EN REALIDAD
% Para entender los fundamentos del método implementado primero debemos analizar mejor los detalles del objetivo
De los conceptos vistos previamente sobre flexibilidad, 
lo que queremos obtener es una   que pertenezca a un ensamble conformacional de gran tamaño, de forma que, asumiendo una velocidad de intercambio , resulte en una estructura flexible capaz de
proveer la flexibilidad necesaria para que los dominios que conecta puedan moverse libremente.
Como vimos a lo largo de la introducción, este tipo de conformación es adoptada por las secuencias que caracterizamos como IDRs/IDPs.
La adopcion de una conformacion intrinsecamente desordenada por parte de la secuencia linker proveera, entonces, la flexibilidad necesaria por su correcto funcionamiento.
Por lo tanto, tenemos un panorama mas claro acerca de cuales serán las características conformacionales de la secuencia que esperamos obtener.

% objetivo conocido en términos estructurales. 
% La idea, entonces, es que la secuencia resultante tenga las características conformacionales propias de una IDR/IDP
Como vimos en la sección \ref{linkerDesign} la flexibilidad no es todo y, por eso, una parte fundamental del objetivo es que el linker obtenido se mantenga inerte frente a cualquier actividad biológica que pueda 
interferir en el proceso se expresión o en la correcto funcionamiento de la proteína resultante del diseño.
% Una parte relevante de esta secuencia objetivo es su inercia frente al pipeline de 


% 
% Uno de los principales aspectos a considerar acerca de la secuencia es el grado de estructuración o desorden que puede adoptar. 

% Una de las principales propiedades que buscamos al diseñar una secuencia linker es la existencia de ésta en un ensamble conformacional 
% de estructuras desordenadas que proveen la flexibilidad necesaria para que los dominios que conecta puedan moverse libremente.


En el capítulo 1 se describieron distintos elementos estructurales y funcionales que pueden estar presentes en una secuencia.
Clasificando, aislando y analizando estos elementos hemos podido comprender mejor cuales son sus propiedades. 
Teniendo en claro los objetivos en términos de los posibles elementos estructurales y funcionales, lo que el método requiere es, entonces, obtener una secuencia que adopte ,que esté limpia de elementos estructurales 
Lo que queda saber, entonces, es cómo se obtendrá una secuencia que cumpla estas características.




Los avances mostrados en este campo se trasladan a una gran cantidad(y variedad) de métodos que permiten predecir la ocurrencia de las estas propiedades sobre una secuencia polipeptídica, tanto natural como artificial.
De forma abstracta, estas herramientas permiten predecir el mapeo entre la secuencia y el perfil de propiedades resultantes. 
% Diferentes herramientas bioinformáticas resultan de trasladar estos conocimientos a
% Estos avances, además, dieron paso al desarrollo de una gran cantidad(y variedad) de herramientas bioinformáticas que permiten predecir éstas propiedades a partir de la secuencia .
% La disponibilidad de estas herramientas permite tener una idea más clara del comportamiento que tendrá una proteína en un contexto experimental dado, solamente conociendo su secuencia y utilizando las herramientas adecuadas. 
% 
Haciendo uso de este amplio set de herramientas podemos analizar cualquier secuencia y estimar si se cumplen los requerimientos buscados.
Queda aún conocer como se 

%  ESTO DEBERIA IR EN ALGUN LADO, NO SE DONDE PONERLO
% Por encima de estos requerimientos se aplican las propiedades extras que son parte de las utilidad extra que ayudan a la utilización experimental de las secuencias resultantes.


% Hipótesis asumida respecto del espacio de soluciones, dependencia de la superficie de búsqueda con las propiedades a evaluar.
% *****************PROPIEDADES DEL ESPACIO DE BUSQUEDA 

% COMPLEJIDAD DE LAS IDPs
% SACADO DE A decade and a half of protein intrinsic disorder: Biology still waits for physics
It was pointed out that IDPs possess noticeable amino acid biases, and many IDPs/IDPRs are characterized by sequence redundancy and low sequence
complexity, containing long stretches of various repeats and being completely devoid of some (often many) types of amino acid residues. 
These observations seem to indicate that the sequence space of IDPs/IDPRs should be simpler than that of ordered proteins.
However, the reality is more complex than conventional wisdom might suggest, and the sequence space attainable by simple IDPs/IDPRs is more diversified than that of the structurally more sophisticated ordered proteins.
In fact, a 100 residue-long protein in which any of the normally occurring 20 amino acids can be found has a sequence space of $20^100$ (aprox. $10^130$) sequences. 
Obviamente, no todas las secuencias al azar se pliegan para dar una estructura unica y, por lo tanto, no cualquier secuencia pertenecerá al conjunto que denominamos como plegadas.
In other words, a sequence space of a foldable protein (or “foldable” sequence space) is noticeably smaller than the entire sequence space available for a random polypeptide chain\cite{dill1999polymer}. 

Foldable proteins fold first and then bind to their partners whereas IDPs/IDPRs remain disordered until they interact with their partners. 
Furthermore, many IDPs/IDPRs do not require folding to be functional, and some of them form fuzzy complexes, in which they preserve significant amount of disorder. 
All this suggests that the sequence space of IDPs (at least those which either do not fold at all or do not completely fold at binding) 
is noticeably greater than the “foldable” sequence space due to the removal of restrictions posed by the need to gain ordered structure spontaneously. 
This represents one of the conundrums of intrinsic disorder, where the apparent sequence redundancy and simplicity are combined with the lack of structural restrains leading to the increase in the dimensions and complexity of the
available sequence space.


% 
% En los últimos años se han realizado importantes avances en el estudio de las relación existente entre la estructura primaria de proteínas y el conjunto de propiedades experimentalmente observables de éstas(\textit{in-vivo} o \textit{in-vitro}). 

% 
% 
% 
% El problema que estamos enfrentando es, sin embargo, el inverso. Queremos  
% Nuevamente, planteandolo de forma abstracta, esto representa mapear el espacio de comportamientos con el espacio de secuencias posibles.
% 
% Claramente, ambos problemas están íntimamente relacionados: un mejor entendimiento de los principios que hacen posible(y necesarios) para que una secuencia tenga un cierto comportamiento, brindarán mayor información
% It is clear that the two problems are closely related to each other: a better understanding of the principles of protein folding makes it possible to clarify which features of protein sequences are necessary (as well as sufficient) 
% for stability and fast folding; in other words, the features that make a protein a protein. 
% Such understanding focuses the attention of designers on emphasizing these crucial features of folding sequences.
% 
% Obtener una secuencia con un comportamiento muy específico(por ejemplo que adquiera una estructura plegada definida), puede ser un requerimiento muy específico.
% Un reflejo de esto puede verse en las estructuras de ciertas proteinas naturales, las cuales tienen una fuerte dependencia con la secuencia que se mantiene altamente conservada. 
% 
% Sin embargo, como se detalló en la sección previa, el objetivo de nuestra herramienta es lograr obtener una secuencia con un comportamiento bastante 'simple' de obtener.... 




% YA DIJE COMO EVALUAR LOS REQUERIMIENTOS
% YA DIJE COMO ERA EL ESPACIO DE SOLUCIONES
% AHORA
% ************EL MÉTODO
De esta forma, estamos en una situación en la que: tenemos un conjunto de herramientas que nos permiten mapear cada secuencia con distintos comportamientos (deseado o no deseados) de acuerdo a nuestro objetivo y, además, 
podemos asumir que el conjunto de secuencias que cumple con los principales comportamientos buscados, es considerablemente grande dentro del espacio de secuencias posibles (cualquier combinación de AAs).

El esquema de búsqueda dependerá de nuestros objetivos y los conocimientos, desconocimientos, hipotesis acerca del espacio de búsqueda.
Una primera aproximación obvia sería probar distintas combinaciones al azar...
El problema es que es una forma totalmente ineficiente de búsqueda, tiene un alto costo computacional y el resultado(asumiendo que lo encontramos) tendrá una composición 
al azar(esto puede no resultar un problema, dependiendo del objetivo especifico).

Una aproximación mas adecuada sería utilizar todo el conocimiento que tenemos para poder evaluar la secuencia. 
La existencia de una función ideal implicaría que esta represente la dependencia de cada posicion con el contexto de la secuencia, con respecto a la propiedad analizada.
Si bien las herramientas disponibles de predicción nos son las ideales, generalmente brindan información sobre cada posición y no sobre la secuencia como un todo.

Uilizando esta información podríamos analizar que posiciones no son acordes con el comportamiento/propiedades deseado/a y utilizar esta información para guiar la búsqueda, modificando solo aquellas posiciones que no nos resultan favorables.
 
Si bien asumimos que el conjunto de secuencia que cumplen las condiciones estandar del resultado es grande con respecto al especio total de soluciones, no conocemos la forma funcional que no esta guiando la busqueda,
es decir, como esta depende con la secuencia.  Para implementar un mecanismo eficiente de búsqueda debemos tener en cuenta este desconocimiento.










\section{Esquema general de la implementación}


\subsection{Secuencia inicial}

El método comienza la búsqueda a partir de una secuencia inicial. 
Esta secuencia puede ser creada de forma aleatoria como primer paso del algoritmo(ver \ref{secuenciaInicialRandom}) o puede ser pasada como parámetro por el usuario \ref{secuenciaInicialDefinida}. 

La generación de una secuencia aleatoria no es un problema trivial. 
En la naturaleza las proteínas están compuestas de un conjunto de 20 aminoácidos, los cuales se encuentran con diferentes abundancias relativas. 
La frecuencia de cada aminoácido dentro de un proteoma está dada por un balance entre el costo metabólico de este y la necesidad de contar con un conjunto de secuencias diversas que darán proteínas funcionales \cite{krick2014amino}. 
Para generar una secuencia aleatoria, entonces, es necesario definir la frecuencia que tendrá cada aminoácido. 
Esta frecuencia se obtiene a partir de la frecuencia global que tiene cada aminoácido en la base de datos de secuencias proteicas.
La aplicación que se utiliza para obtener la secuencia random es RandSeq \cite{randseq}.

Por default, la herramienta utiliza la composición estándar obtenida de SwissProt \cite{compositionAA}.  
Estos valores resultan del cálculo de la composición de aminoácidos de todas las proteínas de la base de datos. 
De esta forma, la composición total representa un consenso de frecuencias de aminoácidos entre todas las secuencias documentadas hasta el momento en la base de datos UniProtKB/Swiss-Prot.
% Los valores de la composición estándar se encuentran en http://web.expasy.org/protscale/pscale/A.A.Swiss-Prot.html

Entre otras que existen, esta herramienta ofrece la posibilidad al usuario de definir las frecuencias que desea para cada aminoácido e, incluso,
indicar solo la frecuencia de algunos residuos en particular, dejando el restos con la frecuencia estándar. 
Nuestra herramienta también ofrece al usuario esta flexibilidad para definir la composición que tendrá la secuencia (ver \ref{composicion})
Esta funcionalidad permitiría, por ejemplo, indicar que cierto aminoácido no esté presente en la secuencia (asignándole una frecuencia igual a 0). 
Para el fin que tiene la herramienta, es útil tener este tipo de funcionalidades ya que permite adaptar los requerimientos a las capacidades(limitaciones) del laboratorio experimental. 
El nuevo linker diseñado deberá poder ser sintetizado eficientemente junto con la nueva proteína, lo cual implica una carga metabólica para el sistema biológico en el cual está siendo producido. 
De esta forma, se intentará adaptar las propiedades de la secuencia diseñada para aumentar la capacidad de síntesis reduciendo, por ejemplo, los aminoácidos que implican un gran gasto energético y que limitarán la producción de la proteína final.




% \subsection{Método de evaluación de la secuencia}


% Para poder implementar la busqueda guiada por información resultante de evaluaciones secuenciales, primero debemos poder representar esta información de forma concreta/cuantitativa.
% Para esto, de cada evaluación realizada sobre la secuencia se extrae un valor binario para cada posición. Un valor = 1 representa una evaluación negativa con respecto al comportamiento deseado, 
% mientras que un valor = 0 implica una evaluación positiva.
% Por ej: .........
% ARMAR EJEMPLOS CON HERRAMIENTAS SIN ESPECIFICAR EL NOMBRE DE ESTA,ej:  LA EVALUACION DE LA HERRAMIENTA A RESULTA EN..... Y LA HERRAMIENTA B RESULTA EN ...
% Los valores correspondientes a distintas
% Por ej. si al analisis previo le agregamos una evaluacion para....

% Usando este esquema, se deduce simplemente que la posicion que tenga el mayor valor será la que mas se aleja de nuestro objetivo.

% Una de las desventajas(quizás no), de este esquema , es que el metodo esta orientado a realizar evaluaciones que permitan derivar un valor binario para cada posicion de la secuencia. 
% Esto, al parecer, no seria un problema, ya que el resultado deberia poder adaptarse a este esquema.


% Ya que no conocemos la función exacta que determina la relacion entre la secuencia y los valores de puntajes en las distintas posiciones(ni tampoco su superficie funcional),
% no podemos conocer como varía el puntaje asociado si realizamos una modificacion sobre la secuencia
% Ademas, esta variacion del puntaje con la secuencia depende de distintos factores, no solo del conjunto de herramientas/evaluaciones realizadas, sino también de los parámetros utilizados para éstas.
% La implementación de la búsqueda deberá tener esto en cuenta para realizar una busqueda guiada por estos valores.





\subsection{Búsqueda heurística/guiada}


% TENIENDO EN CUENTA ESTAS CONSIDERACIONES, EL ESQUEMA QUE USAMOS NOS PERMITE REALIZAR UN NUMERO REDUCIDO DE MUTACIONES YA QUE SE APUNTA A LAS POSICIONES CON MAS CONFLICTO, 
% ADEMAS EL PARAMETRO BETA PERMITE ADAPTAR LA BUSQEUDA A DISTINTAS FORMAS DE LA SUPERFICIE DEL ESPACIO DE SOLUCIONES, LAS CUAL DEPENDE DE LAS CONDICIONES DE LOS PARAMETROS QUE USAMOS(COMPOSICION, THRESHOLDS, HERRAMIENTAS).
% ES DECIR SI LA SUPERFICIE TIENE MINIMOS LOCALES QUE DEBAN SER SUPERADOS, UN VALOR DE BETA MAS ALTO RELAJA LAS RESTRICCIONES PARA
% ACEPTAR MUTACIONES Y POR LO TANTO PERMITE . CUANDO LA SUPERFICIE ES MAS 'PLANA', UN VALOR DE BETA MENOR PERMITE ENCONTRAR LA SOLUCION CON UN MENOR NUMERO DE MUTACIONES(LO QUE NO SIGNIFICA QUE SEA MAS RAPIDO)
% En este caso, la función a optimizar está dada por el resultado de todas las evaluaciones que queremos realizar.


El procedimiento general del algoritmo consiste en iterar sobre la secuencia inicial, evaluando en cada paso las propiedades de cada posición de la secuencia con respecto a características de interés. 
Los resultados de cada evaluación serán reflejados en un valor numérico o puntuación asociado a cada posición
(el capítulo \ref{tools} se centra en las propiedades evaluadas y como se aplican las herramientas utilizadas para dar un valor numérico a cada posición). 
En cada iteración el puntaje es inicializado en 0 para todas las posiciones y cada evaluación ejecutada puede aumentar o mantener el valor, de manera tal que, 
al finalizar todas las evaluaciones correspondientes a una iteración, el puntaje de cada posición tendrá un valor mayor o igual a cero.
El aumento de este puntaje depende de la concordancia que tiene cada posición con las características evaluadas
En cada evaluación \textbf{se aumenta el valor si el residuo en esa posición NO favorece la propiedad deseada}.

Un ejemplo de evaluación de la secuencia mediante dos herramientas hipotéticas A y B sería: % PONER EJEMPLO PARA QUE QUEDE CLARO
\rule[-0.7\baselineskip]{0pt}{\baselineskip}
\begin{tabular}{lllllllllll} 
Secuencia: &  M & V & L & S & P & A & D & K & T & N\\ 
Puntaje Inicial: & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
Evaluación con herramienta A & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
Evaluación con herramienta B & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
Puntaje global & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
\end{tabular}


Al terminar todas las evaluaciones de cada iteración, el puntaje resultante se utiliza para el proceso de mutación.
% POR QUE HACEMOS UNA MUTACION DE A 1 PASO, ES DECIR 1 SOLA MUTACION POR VEZ? 


\vspace{0.5cm}
El proceso de mutación sigue los siguientes pasos:
\begin{enumerate}
 \item En primer lugar se selecciona uno de los residuos de la secuencia como objetivo para realizar la mutación. 
 Esta selección será ponderada. El factor de ponderación utilizado sera el valor resultante de sumar 1 al puntaje global asociado a la posición.
 Siguiendo el ejemplo anterior:
 
 \begin{tabular}{lllllllllll} 
Secuencia: &  M & V & L & S & P & A & D & K & T & N\\ 
Puntaje global & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
Factor de ponderación & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
\end{tabular}
 
\vspace{0.5cm}
Esta forma de calcular el factor de ponderación implica que nuncá se tendrán factores iguales a cero y, por lo tanto, siempre se podrá seleccionar alguna posición para mutar.

%  Se debe tener en cuenta que, como se mencionó previamente, el valor del puntaje resultante puede ser igual a 0 y, si esto se repite para todas las posiciones, puede ocurrir que ningún residuo sea factible de ser seleccionado, en cuyo caso no se continúa el proceso de mutación. 
   \item El segundo paso, consiste en seleccionar con que aminoácido se sustituirá la posición seleccionada. 
   Esta selección se realiza siguiendo la misma composición que se definió al iniciar la ejecución \ref{composicion}. 
   Dado que la selección del sustituto es independiente del tipo de residuo seleccionado para mutar,
   es posible que el mutado y su reemplazo seleccionado sean iguales. 
   En este caso simplemente se vuelve a seleccionar un sustituto hasta que el resultado sea un residuo distinto al anterior.     
    \item El tercer paso consiste en aceptar o rechazar la mutación propuesta.
    Para realizar esto, primero se vuelve a evaluar el puntaje, analizando todas las características deseadas de la secuencia pero, esta vez, sobre la secuencia que contiene la mutación propuesta.
    Este resultado nos permite saber como se modifiarán los puntajes si aceptaramos la mutación.
    La mutación se acepta o rechaza siguiendo el método de decisión de Monte Carlo. 
    Este método deriva una probabilidad de aceptación a partir de los puntajes globales(suma de todos los puntajes de la secuencia) evaluados antes($P_previo$) y después($P_posterior$) de la mutación propuesta.
    La probabilidad resulta de calcular:
    
    $Probabilidad aceptación MC= \frac{-(Puntaje  - Puntaje_{antes-mutacion})}{\beta}$
    
    En caso de no aceptarse la mutación propuesta el algoritmo vuelve al paso 1.
\end{enumerate}



% De forma resumida, solo se incorporan mutaciones que se traduzcan en una disminución del puntaje total de la secuencia.


Dado que el objetivo final es obtener una secuencia que posea, con cierta probabilidad, todas las características deseadas, 
el algoritmo finaliza cuando el puntaje resultante sea igual a cero, o cuando se cumple alguna de las condiciones de finalización \ref{condicionFin}. 
% Esto implica que todas las evaluaciones concuerdan con los objetivos buscados en el diseño de la secuencia linker.


% DIBUJAR DIAGRAMA DE FLUJO O PSEUDOCODIGO DEL ALGORITMO
En la figura \ref{fig:esquema-algoritmo} se ve un esquema general del método completo.



\begin{figure}[ht]
\centering
   \includegraphics[width=\textwidth]{img/diagrama-algoritmo.png}
 \caption{Esquema general del método aplicado para obtener la secuencia final}
 \label{fig:esquema-algoritmo}
\end{figure}



